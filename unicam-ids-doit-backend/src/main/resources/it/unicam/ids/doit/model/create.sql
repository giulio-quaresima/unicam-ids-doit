---------------------------------------------------
-- Generated by it.unicam.ids.doit.model.ddl.DDL --
-- at 2021-06-07T20:34:01.038626Z                --
---------------------------------------------------

    create table account (
       email varchar(255),
        username varchar(255),
        id integer not null,
        primary key (id)
    );

    create table appartenenza (
       id integer generated by default as identity,
        membro integer,
        organizzazione integer,
        primary key (id)
    );

    create table appartenenza_autorizzazioni (
       appartenenza_id integer not null,
        autorizzazioni varchar(255)
    );

    create table candidatura (
       id integer generated by default as identity,
        autopromozione varchar(255),
        incarico varchar(255),
        inviata boolean not null,
        selezionata boolean not null,
        progetto_id integer not null,
        soggetto_id integer not null,
        primary key (id)
    );

    create table competenza (
       id integer generated by default as identity,
        tag varchar(255),
        primary key (id)
    );

    create table invito (
       id integer generated by default as identity,
        accettazione boolean,
        note_accettazione varchar(255),
        note_invito varchar(255),
        candidatura_id integer not null,
        invitato_id integer not null,
        primary key (id)
    );

    create table progetto (
       id integer generated by default as identity,
        descrizione clob,
        obiettivi clob,
        stato varchar(32),
        titolo varchar(255),
        proponente_id integer not null,
        primary key (id)
    );

    create table progetto_competenza (
       id_progetto integer not null,
        id_competenza integer not null,
        primary key (id_progetto, id_competenza)
    );

    create table soggetto (
       discriminator_column char(31) not null,
        id integer generated by default as identity,
        primary key (id)
    );

    create table soggetto_utente_competenza (
       id_soggetto_utente integer not null,
        id_competenza integer not null,
        primary key (id_soggetto_utente, id_competenza)
    );

    create table soggetto_collettivo (
       denominazione varchar(255),
        id integer not null,
        primary key (id)
    );

    create table soggetto_utente (
       cognome varchar(255),
        nome varchar(255),
        id integer not null,
        primary key (id)
    );

    alter table appartenenza 
       add constraint UKg5nooccab2b6fkxx5drwo4hbt unique (organizzazione, membro);

    alter table account 
       add constraint FKnqaiy90ei86hie9l7mcrk0715 
       foreign key (id) 
       references soggetto_utente;

    alter table appartenenza 
       add constraint FKi9e9ukfiqeuhthtxse07k0dnq 
       foreign key (membro) 
       references soggetto_utente;

    alter table appartenenza 
       add constraint FK2g1slostnx0hv8ml7ldcm3qv9 
       foreign key (organizzazione) 
       references soggetto_collettivo;

    alter table appartenenza_autorizzazioni 
       add constraint FKrids4e1dmrc9cau1yvqqube2c 
       foreign key (appartenenza_id) 
       references appartenenza;

    alter table candidatura 
       add constraint FKfwc09vi8rk6qfmtnethsyprtq 
       foreign key (progetto_id) 
       references progetto;

    alter table candidatura 
       add constraint FK60v7vlu62ns1phrmwu299l3dy 
       foreign key (soggetto_id) 
       references soggetto;

    alter table invito 
       add constraint FKfbmm3gcfqskcscpds43ka7yaa 
       foreign key (candidatura_id) 
       references candidatura;

    alter table invito 
       add constraint FKqlfg95j9f6tvobe182d4pk9n6 
       foreign key (invitato_id) 
       references soggetto;

    alter table progetto 
       add constraint FKc1xvtuoe4i0304j9e6i1sddk 
       foreign key (proponente_id) 
       references soggetto_collettivo;

    alter table progetto_competenza 
       add constraint FKqmip5w68ai9ueh8looo3yoqc1 
       foreign key (id_competenza) 
       references competenza;

    alter table progetto_competenza 
       add constraint FKfs94nrl3lwuwxh5mwn0nmwpwl 
       foreign key (id_progetto) 
       references progetto;

    alter table soggetto_utente_competenza 
       add constraint FKa0ytxe7tjao59cpserrmb4s5h 
       foreign key (id_competenza) 
       references competenza;

    alter table soggetto_utente_competenza 
       add constraint FKfyjv0t0g6rtimh0xhrynha3q3 
       foreign key (id_soggetto_utente) 
       references soggetto_utente;

    alter table soggetto_collettivo 
       add constraint FKcua854gf08awjbpo8firrkcp0 
       foreign key (id) 
       references soggetto;

    alter table soggetto_utente 
       add constraint FKr4ac3d3ofiycub3d0614ftvq4 
       foreign key (id) 
       references soggetto;
